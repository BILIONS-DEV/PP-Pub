(()=>{var e={idSelect:"#list_inventory",idBox:".box_inventory",idIsMoreData:"#is_more_inventory",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_inventory",urlAjax:"/target/loadInventory",optionAjax:"domain",filterAjax:[],list_selected:[],btnInclude:"add_inventory",btnRemove:"remove_inventory",idEmpty:"empty_ad_domain",text:"#text_for_domain",btnRemoveAll:"remove_all_domain",btnSelectAll:"select_all_domain",block:".block_domain",container:".container_domain",boxEmpty:"box_empty_domain",checkLoadMore:!1},t={idSelect:"#list_ad_tag",idBox:".box_ad_tag",idIsMoreData:"#is_more_tag",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_ad_tag",urlAjax:"/target/loadInventory",optionAjax:"adtag",filterAjax:[],list_selected:[],btnInclude:"add_tag",btnRemove:"remove_tag",idEmpty:"empty_ad_tag",text:"#text_for_tag",btnRemoveAll:"remove_all_tag",btnSelectAll:"select_all_tag",block:".block_tag",container:".container_tag",boxEmpty:"box_empty_tag",checkLoadMore:!1},a={idSelect:"#list_ad_format",idBox:".box_ad_format",idIsMoreData:"#is_more_adformat",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_ad_format",urlAjax:"/target/loadInventory",optionAjax:"adformat",filterAjax:[],list_selected:[],btnInclude:"add_format",btnRemove:"remove_adFormat",idEmpty:"empty_ad_format",text:"#text_for_format",btnRemoveAll:"remove_all_format",btnSelectAll:"select_all_format",block:".block_format",container:".container_format",boxEmpty:"box_empty_format",checkLoadMore:!1},i={idSelect:"#list_ad_size",idBox:".box_ad_size",idIsMoreData:"#is_more_adsize",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_ad_size",urlAjax:"/target/loadInventory",optionAjax:"adsize",filterAjax:[],list_selected:[],btnInclude:"add_size",btnRemove:"remove_adSize",idEmpty:"empty_ad_size",text:"#text_for_size",btnRemoveAll:"remove_all_size",btnSelectAll:"select_all_size",block:".block_size",container:".container_size",boxEmpty:"box_empty_size",checkLoadMore:!1},o={idSelect:"#list_geography",idBox:".box_geography",idIsMoreData:"#is_more_geography",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_geography",urlAjax:"/target/loadInventory",optionAjax:"geography",list_selected:[],btnInclude:"add_country",btnRemove:"remove_Geo",idEmpty:"empty_ad_geo",text:"#text_for_geo",btnRemoveAll:"remove_all_geo",btnSelectAll:"select_all_geo",block:".block_geo",container:".container_geo",boxEmpty:"box_empty_geo",checkLoadMore:!1},n={idSelect:"#list_device",idBox:".box_device",idIsMoreData:"#is_more_device",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_device",urlAjax:"/target/loadInventory",optionAjax:"device",list_selected:[],list_original:[],btnInclude:"add_device",btnRemove:"remove_device",idEmpty:"empty_ad_device",text:"#text_for_device",btnRemoveAll:"remove_all_device",btnSelectAll:"select_all_device",block:".block_device",container:".container_device",boxEmpty:"box_empty_device",checkLoadMore:!1},s={inventory:[],format:[],size:[]};function l(e,t){switch(e.status){case"error":1===e.errors.length&&""===e.errors[0].id?new AlertError(e.errors[0].message):e.errors.length>0?($.each(e.errors,(function(e,t){var a=$("#"+t.id);a.addClass("is-invalid").nextAll("span.invalid-feedback").text(t.message),a.parent().addClass("is-invalid").nextAll("span.invalid-feedback").text(t.message)})),$("#"+e.errors[0].id).focus(),$("#"+e.errors[0].id).prev("label").focus()):new AlertError("Error!");break;case"success":NoticeSuccess("Floor has been updated successfully");break;default:new AlertError("Undefined")}}function r(s,l){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",d=$("#"+s);function c(){var s=$(".submit"),c=s.text(),p=d.serializeObject();p.listData=e.list_selected,p.listGeo=o.list_selected,p.listDevice=n.list_selected,p.listAdtag=t.list_selected,p.listAdFormat=a.list_selected,p.listAdSize=i.list_selected,p.id=parseInt(p.id),p.priority=parseInt(p.priority),p.floor_type=parseInt(p.floor_type),1==p.floor_type?p.floor_value=0:""!==p.floor_value?p.floor_value=parseFloat(p.floor_value):p.floor_value=0,"on"===p.status?p.status=1:p.status=2,$.ajax({url:r,type:"POST",dataType:"JSON",contentType:"application/json",data:JSON.stringify(p),beforeSend:function(e){s.attr("disabled",!0).text("Loading...")},error:function(e,t){var a=AjaxErrorMessage(e,t);new AlertError("AJAX ERROR: "+a),s.attr("disabled",!1).text(c)},success:function(e){s.attr("disabled",!1).text(c)},complete:function(e){l(e.responseJSON,d)}})}d.find("input").on("input",(function(e){var t=$(this);t.hasClass("is-invalid")&&t.removeClass("is-invalid").next(".invalid-feedback").empty()})),d.find("textarea").on("input",(function(e){var t=$(this);t.hasClass("is-invalid")&&t.removeClass("is-invalid").next(".invalid-feedback").empty()})),$(d).on("keypress","input",(function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),c())})),d.find(".submit").on("click",(function(e){e.preventDefault(),c()}))}function d(o){!function(o){$(o.idBox).find("."+o.btnRemove).each((function(n,l){var r=parseInt(l.id),d=l.name;switch(o.list_selected.push({id:r,name:d}),o){case e:s.inventory.push(r);break;case a:s.format.push(r);break;case i:s.size.push(r);break;case t:t.filterAjax.push(r)}})),y(o)}(o),c(o),function(o){$(o.idSelect).on("click","button."+o.btnInclude,(function(e){!function(e,a,i){a.preventDefault();var o=parseInt(e.data("id")),n=e.attr("name");$(i.idSelect).find("div[id = '".concat(o,"']")).remove(),u(o,n,i),f(o,-1,i),i.optionAjax!==t.optionAjax&&h()}($(this),e,o),function(e){350===$(e.idSelect).get(0).scrollHeight&&e.isMoreData&&(e.search=$(e.idSearch).val(),e.isSearch=!1,m(e))}(o),v(o),$(this).hasClass("add_inventory")&&$(".domain-card").removeClass("domain-card-invalid")})),$(o.idSearch).on("keyup keypress",(function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1})),$(o.idSearch).on("input",(function(){o.page=1,o.isSearch=!0,o.lastPage=!1,o.search=$(this).val(),m(o),p(o)})),$(o.block).on("click","a."+o.btnRemoveAll,(function(n){n.preventDefault(),function(o){o.list_selected.map((function(e){g(e.id,e.name,o)})),o.list_selected.map((function(n){switch(o.optionAjax){case e.optionAjax:var l=s.inventory.indexOf(n.id);l>-1&&s.inventory.splice(l,1),t.page=1,t.isSearch=!0,m(t);break;case a.optionAjax:var r=s.format.indexOf(n.id);r>-1&&s.format.splice(r,1),t.page=1,t.isSearch=!0,m(t);break;case i.optionAjax:var d=s.size.indexOf(n.id);d>-1&&s.size.splice(d,1),t.page=1,t.isSearch=!0,m(t);break;case t.optionAjax:var c=t.filterAjax.indexOf(n.id);c>-1&&t.filterAjax.splice(c,1)}})),o.list_selected=[],$(o.idSelect).html(""),o.page=1,o.isSearch=!1,o.isMoreData=!0,m(o),c(o),y(o)}(o)})),$(o.idBox).on("click","button."+o.btnRemove,(function(n){!function(o,n,l){n.preventDefault();var r=parseInt(o.attr("id")),d=o.attr("name");switch(o.closest(".item_selected").remove(),g(r,d,l),u(r,d,l),l.optionAjax){case e.optionAjax:var c=s.inventory.indexOf(r);c>-1&&s.inventory.splice(c,1),t.page=1,t.isSearch=!0,m(t);break;case a.optionAjax:var p=s.format.indexOf(r);p>-1&&s.format.splice(p,1),t.page=1,t.isSearch=!0,m(t);break;case i.optionAjax:var v=s.size.indexOf(r);v>-1&&s.size.splice(v,1),t.page=1,t.isSearch=!0,m(t);break;case t.optionAjax:var _=t.filterAjax.indexOf(r);_>-1&&t.filterAjax.splice(_,1)}}($(this),n,o),v(o)}))}(o),p(o)}function c(e){if(0===e.list_selected.length)$(e.idBox).html(""),$(e.idBox).append('<div id="'.concat(e.idEmpty,'" class="d-flex flex-row align-items-center px-md-2" style="height: 25px">\n            <div class="col p-0"><h6\n                        class="m-0 font-weight-semibold fs-12 text-center">\n                    No data selected</h6></div>\n        </div>'));else{$("."+e.btnRemoveAll).attr("hidden",!1);var t="#"+e.idEmpty;$(t).remove()}}function p(e){$(e.idSelect).on("scroll",(function(){var t=$(this).get(0),a=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e+t+1>=a}(Math.round(t.scrollTop),t.clientHeight,t.scrollHeight);a&&e.isMoreData&&(e.search=$(e.idSearch).val(),e.isSearch=!1,e.checkLoadMore||m(e))}))}function v(e){var t=$(e.idSelect).find("div.target-item"),a=$("."+e.boxEmpty);t.length>0?a.length>0&&a.attr("hidden",!0):a.length>0?a.attr("hidden",!1):$(e.idSelect).append('<div class="list-group list-group-flush my-n3 pt-3 '.concat(e.boxEmpty,'">\n                <div class="list-group-item">\n                    <div class="d-flex flex-row align-items-center px-md-2">\n                        <div class="col p-0 text-center"><h6 class="m-0 font-weight-semibold fs-12">No data available</h6></div>\n                    </div>\n                </div>\n            </div>'))}function m(e){var a;e.checkLoadMore=!0,a=0===e.page?e.page+1:e.page;var i=[];e.list_selected.map((function(e){i.push(e.id)})),$.ajax({url:e.urlAjax,type:"GET",data:{key:a,search:e.search,option:e.optionAjax,filter:JSON.stringify(s),selected:JSON.stringify(i)},success:function(a){e.isSearch&&$(e.idSelect).html(""),$(e.idSelect).append(a.data),e.isMoreData=a.is_more_data,$(e.idIsMoreData).val(a.is_more_data),!0===a.is_more_data&&(e.page=a.current_page+1),e.checkLoadMore=!1,e.lastPage=a.last_page,b(e),function(e,a){if(e.optionAjax===t.optionAjax){var i=[];t.list_selected.map((function(e,o){-1===a.indexOf(e.id)&&($(t.idBox).find("div[id = '".concat(e.id,"']")).remove(),i.push(o))}));for(var o=i.length-1;o>=0;o--)t.list_selected.splice(i[o],1);var n=[];$.each(t.filterAjax,(function(e,t){-1===a.indexOf(t)&&n.push(e)}));for(var s=n.length-1;s>=0;s--)t.filterAjax.splice(n[s],1);c(t)}}(e,a.list_filter),y(e),function(e,t,a){t<7&&1===a||(e.lastPage||t>7||0===t)&&($("."+e.boxEmpty).remove(),$(e.idSelect).append('<div class="list-group list-group-flush my-n3 pt-3 '.concat(e.boxEmpty,'">\n        <div class="list-group-item">\n            <div id="').concat(e.idEmptyLoad,'" class="d-flex flex-row align-items-center px-md-2">\n                <div class="col p-0 text-center"><h6 class="m-0 font-weight-semibold fs-12">No data available</h6></div>\n            </div>\n        </div>\n    </div>')))}(e,a.total,a.current_page)},error:function(e){console.log(e)}})}function _(t,o){$.ajax({url:"/target/filterAdTag",type:"POST",contentType:"application/json",data:JSON.stringify({type:o,tagId:t.filterAjax,serverType:parseInt($("#server_type").val())}),success:function(t){!function(t){var o;t.inventory_id.map((function(t){var a=(o=e).list_selected.map((function(e){return e.id})).indexOf(t.id);-1===a&&(o.list_selected.push({id:t.id,name:t.name}),x(t.id,t.name,o)),b(o),y(o),c(o),f(t.id,a,o)})),t.ad_format_id.map((function(e){var t=(o=a).list_selected.map((function(e){return e.id})).indexOf(e.id);-1===t&&(o.list_selected.push({id:e.id,name:e.name}),x(e.id,e.name,o)),b(o),y(o),c(o),f(e.id,t,o)})),t.ad_size_id.map((function(e){var t=(o=i).list_selected.map((function(e){return e.id})).indexOf(e.id);-1===t&&(o.list_selected.push({id:e.id,name:e.name}),x(e.id,e.name,o)),b(o),y(o),c(o),f(e.id,t,o)})),h()}(t)},error:function(e){console.log(e)}})}function f(o,n,l){switch(l.optionAjax){case e.optionAjax:-1===n&&s.inventory.push(o);break;case a.optionAjax:-1===n&&s.format.push(o);break;case i.optionAjax:-1===n&&s.size.push(o);break;case t.optionAjax:t.filterAjax.push(o),_(t,"include")}}function h(){t.page=1,t.isSearch=!0,m(t)}function u(e,t,a){var i=a.list_selected.map((function(e){return e.id})).indexOf(e);-1===i?(a.list_selected.push({id:e,name:t}),x(e,t,a)):a.list_selected.splice(i,1),y(a),c(a)}function g(e,t,a){$(a.idSelect).append('\n    <div class="dm20 target-item" id="'.concat(e,'">\n        <span>').concat(t,'</span>\n        <button class="').concat(a.btnInclude,'" data-id="').concat(e,'" name="').concat(t,'" type="button">\n            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">\n                <path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"></path>\n            </svg>\n        </button>\n    </div>'))}function x(e,t,a){$(a.idBox).append('\n        <div class="dm20 target-item item_selected" id="'.concat(e,'">\n            <span>').concat(t,'</span>\n            <button class="').concat(a.btnRemove,'" id="').concat(e,'" name="').concat(t,'" type="button">\n                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-dash-lg" viewBox="0 0 16 16">\n                    <path d="M0 8a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1z"></path>\n                </svg>\n            </button>\n        </div>'))}function b(e){e.list_selected.map((function(t){$(e.idSelect).find("div[id = '".concat(t.id,"']")).remove()}))}function y(s){var l=s.list_selected.map((function(e){return" ".concat(e.name)})).join(),r=l.length;if(r>40){$(s.text).prev().attr("hidden",!0);var d=l.substring(0,39);$(s.text).html(d+"....")}else if(r>0)$(s.text).prev().attr("hidden",!0),$(s.text).html(l);else switch($(s.text).prev().removeAttr("hidden"),s){case e:$(s.text).html("all domains");break;case a:$(s.text).html("all formats");break;case i:$(s.text).html("all sizes");break;case t:$(s.text).html("all ad tags");break;case o:$(s.text).html("all geographies");break;case n:$(s.text).html("all devices")}}$(document).ready((function(){$(".floor-tab").on("click",".nav-link",(function(){$(".floor-tab").find(".nav-link").removeClass("pp-4"),$(this).addClass("pp-4"),"1"!=$(this).attr("data-tab")?$(this).addClass("at-1"):$(".floor-tab").find(".at-1").removeClass("at-1")})),$('[data-toggle="collapse"]').on("click",(function(){var e=$(this);e.toggleClass("dm14"),e.hasClass("dm14")?e.find(".dm23").find("button").html('<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-dash-lg" viewBox="0 0 16 16">\n<path d="M0 8a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1z">\n</path>\n</svg>'):e.find(".dm23").find("button").html('<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">\n<path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"></path>\n</svg>'),$("#nav-target").find('[data-toggle="collapse"]').each((function(){e[0]!=$(this)[0]&&($(this).removeClass("dm14"),$(this).find(".dm23").find("button").html('<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">\n<path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"></path>\n</svg>'))}))})),$('[data-bs-toggle="popover"]').popover({html:!0,sanitize:!1}),new r("AddBidder",l),function(){var e=$("#floor_type").val();1===(e=parseInt(e))?($(".box-floor-value").addClass("d-none"),$(".floor_type_hard").addClass("d-none"),$(".floor_type_dynamic").removeClass("d-none")):($(".box-floor-value").removeClass("d-none"),$(".floor_type_dynamic").addClass("d-none"),$(".floor_type_hard").removeClass("d-none"));$("#floor_type").change((function(){var e=$(this).val();1===(e=parseInt(e))?($(".box-floor-value").addClass("d-none"),$(".floor_type_hard").addClass("d-none"),$(".floor_type_dynamic").removeClass("d-none")):($(".box-floor-value").removeClass("d-none"),$(".floor_type_dynamic").addClass("d-none"),$(".floor_type_hard").removeClass("d-none"))}))}()})),$(document).ready((function(){e.isMoreData="true"===$("#is_more_inventory").val(),e.lastPage="true"===$("#last_page_domain").val(),a.isMoreData="true"===$("#is_more_adformat").val(),a.lastPage="true"===$("#last_page_format").val(),i.isMoreData="true"===$("#is_more_adsize").val(),i.lastPage="true"===$("#last_page_size").val(),t.isMoreData="true"===$("#is_more_tag").val(),t.lastPage="true"===$("#last_page_tag").val(),o.isMoreData="true"===$("#is_more_geography").val(),o.lastPage="true"===$("#last_page_geo").val(),n.isMoreData="true"===$("#is_more_device").val(),n.lastPage="true"===$("#last_page_device").val(),d(e),d(t),d(a),d(i),d(o),d(n),h()}))})();