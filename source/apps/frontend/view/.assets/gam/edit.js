(()=>{function s(s){var e=0,a=0,t=0;s.forEach((function(s){2===s.status&&(e++,1===s.api_access&&a++,1===s.push_line_item&&t++)})),e>0?($(".step-select").addClass("active").find("span.circle").removeClass("bg-gray-200").addClass("bg-primary"),a===e?($(".step-api-access").addClass("active").find("span.circle").removeClass("bg-gray-200").addClass("bg-primary"),t===e?$(".step-push-line").addClass("active").find("span.circle").removeClass("bg-gray-200").addClass("bg-primary"):$(".step-push-line").hasClass("active")&&$(".step-push-line").removeClass("active").find("span.circle").removeClass("bg-primary").addClass("bg-gray-200")):($(".step-api-access").hasClass("active")&&$(".step-api-access").removeClass("active").find("span.circle").removeClass("bg-primary").addClass("bg-gray-200"),$(".step-push-line").hasClass("active")&&$(".step-push-line").removeClass("active").find("span.circle").removeClass("bg-primary").addClass("bg-gray-200"))):($(".step-select").hasClass("active")&&$(".step-select").removeClass("active").find("span.circle").removeClass("bg-primary").addClass("bg-gray-200"),$(".step-api-access").hasClass("active")&&$(".step-api-access").removeClass("active").find("span.circle").removeClass("bg-primary").addClass("bg-gray-200"),$(".step-push-line").hasClass("active")&&$(".step-push-line").removeClass("active").find("span.circle").removeClass("bg-primary").addClass("bg-gray-200"))}function e(e){$.ajax({url:"/gam/get-networks",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({gam_id:parseFloat(e)}),success:function(e){e.length>0&&(t(e),n(e),a(e),function(s){var e=!1;s.forEach((function(s){2===s.status&&(e=!0)})),e||($(".buttonCheckApi").addClass("d-none"),$(".table-api-access").addClass("d-none"),$(".btn-push-line-item").addClass("d-none"),$(".box-push-line-item").addClass("d-none"))}(e),s(e))},error:function(s){console.log(s)}})}function a(s){var e="",a=0,t=0,n=0,i=0;s.forEach((function(s){2===s.status&&1===s.api_access&&(a++,1!==s.push_line_item&&3!==s.push_line_item?t++:3===s.push_line_item?n++:1===s.push_line_item&&i++)})),a>0?(t>0?(e="Push Line Item",$(".btn-push-line-item").removeAttr("disabled"),$(".btn-push-line-item").removeClass("d-none")):n>0?(e="In Processing",$(".btn-push-line-item").attr("disabled",!0),$(".btn-push-line-item").removeClass("d-none")):(e="Push Line Item",$(".btn-push-line-item").removeAttr("disabled"),i===a?$(".btn-push-line-item").addClass("d-none"):$(".btn-push-line-item").removeClass("d-none")),$(".btn-push-line-item").text(e)):$(".btn-push-line-item").addClass("d-none")}function t(s){var e="",a=!1;s.forEach((function(s){2===s.status&&1!==s.api_access&&(a=!0),2===s.status&&(e+='\n            <tr>\n                    <td class="fw-normal">'.concat(s.network_id,'</td>\n                    <td class="fw-normal">').concat(s.network_name,'</td>\n                    <td class="clear">\n            ').concat(1===s.api_access?'\n                                <button class="btn btn-sm btn-icon btn-success circle circle-sm float-end" disabled>\n                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"\n                                             fill="currentColor" class="bi bi-check-lg" viewBox="0 0 16 16">\n                                            <path d="M13.485 1.431a1.473 1.473 0 0 1 2.104 2.062l-7.84 9.801a1.473 1.473 0 0 1-2.12.04L.431 8.138a1.473 1.473 0 0 1 2.084-2.083l4.111 4.112 6.82-8.69a.486.486 0 0 1 .04-.045z"/>\n                                        </svg>\n                                </button>\n                                ':'\n                                <button class="btn btn-sm btn-icon btn-danger circle circle-sm float-end"\n                                    disabled>\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"\n                                         fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">\n                                        <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/>\n                                    </svg>\n                                </button>\n                                ',"\n                    </td>\n            </tr>")),a?$(".buttonCheckApi").removeClass("d-none"):$(".buttonCheckApi").addClass("d-none")})),$(".table-api-access").removeClass("d-none"),$(".btn-push-line-item").removeClass("d-none"),$(".box-push-line-item").removeClass("d-none"),$(".api_access").html(e.trim())}function n(s){var e="";s.forEach((function(s){if(2===s.status&&1===s.api_access){var a="";switch(s.push_line_item){case 1:a='<span class="text-success">Pushed</span>';break;case 2:a='<span class="text-danger">Unachievable</span>';break;case 3:a="<span>In Process</span>";break;default:a="<span>Not been pushed ever</span>"}e+='\n                 <tr data-id="'.concat(s.id,'" data-status-push="').concat(s.push_line_item,'">\n                    <td class="fw-normal">').concat(s.network_id,'</td>\n                    <td class="fw-normal">').concat(s.network_name,'</td>\n                    <td class="fw-normal">\n                        <span class="fs-12 float-end notify-push-line-item">').concat(a,"</span>\n                    </td>\n                </tr>")}else if(2===s.status&&1!==s.api_access){e+='\n                 <tr data-id="'.concat(s.id,'" data-status-push="5">\n                    <td class="fw-normal">').concat(s.network_id,'</td>\n                    <td class="fw-normal">').concat(s.network_name,'</td>\n                    <td class="fw-normal">\n                        <span class="fs-12 float-end notify-push-line-item">').concat("Please Check Api Enable","</span>\n                    </td>\n                </tr>")}})),$(".networkPushLineItem").html(e.trim())}$(document).ready((function(){var i;i=parseInt($("#flexSwitchCheckChecked").data("gam-id")),$(".load-history").attr("data-id",i),e(i),$(".buttonPushLineItem").on("click",".btn-push-line-item",(function(){var s=[];$("table > tbody.networkPushLineItem  > tr").each((function(e,a){var t=$(this).data("status-push");1!==t&&3!==t&&s.push(parseInt($(this).data("id")))})),function(s){$.ajax({url:"/gam/pushLine",type:"POST",data:JSON.stringify({gam_network_ids:s}),success:function(s){switch(s.status){case"error":new AlertError("Error!");break;case"success":NoticeSuccess("Line item is in process"),$(".btn-push-line-item").attr("disabled",!0).text("In Processing"),$(".box-push-line-item table tr").each((function(){var s=$(this).find(".notify-push-line-item"),e=$(this).data("status-push");1!==e&&3!==e&&s.text("In Progress")}));break;default:new AlertError("Undefined")}},error:function(s){console.log(s)}})}(s)})),$(".buttonCheckApi").on("click",(function(){!function(e){var i=e.text(),c="Loading...",r=0,o=[];$("input[id=flexSwitchCheckChecked]").each((function(){$(this).prop("checked")&&(r=parseInt($(this).data("gam-id")),o.push(parseInt($(this).val())))})),$.ajax({url:"/gam/checkApiAccess",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({gam_id:r,list_network:o}),beforeSend:function(s){e.attr("disabled",!0).text(c)},success:function(c){switch(c.status){case"error":new AlertError(c.message);break;case"success":c.networks.forEach((function(s){2===s.status&&1===s.api_access?new NoticeSuccess("Check API Access: "+s.network_name+" API Access Enable"):2===s.status&&1!==s.api_access&&new NoticeError("Check API Access: "+s.network_name+" API Access Disabled")})),t(c.networks),n(c.networks),a(c.networks),$(".box-push-line-item").removeClass("d-none"),$(".table-api-access").removeClass("d-none"),s(c.networks);break;default:new AlertError("Undefined")}e.attr("disabled",!1).text(i)},error:function(s){console.log(s),e.attr("disabled",!1).text(i)}})}($(this))})),$(".networkSelect").on("change",".select-network",(function(){var s=parseFloat($(this).data("gam-id")),a=parseFloat($(this).val()),t=$(this).prop("checked");$.ajax({url:"/gam/select-network",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({gam_id:s,network_id:a,select:t}),success:function(a){switch(a.status){case"error":new AlertError(a.message);break;case"success":new NoticeSuccess(a.message),e(s);break;default:new AlertError("Undefined")}},error:function(s){console.log(s)}})}))}))})();