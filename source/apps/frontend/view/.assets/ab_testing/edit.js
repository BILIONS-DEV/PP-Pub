(()=>{$(document).ready((function(){var o;$(".ab-testing-tab").on("click",".nav-link",(function(){$(".ab-testing-tab").find(".nav-link").removeClass("pp-4"),$(this).addClass("pp-4"),"1"!=$(this).attr("data-tab")?$(this).addClass("at-1"):$(".ab-testing-tab").find(".at-1").removeClass("at-1")})),$('[data-toggle="collapse"]').on("click",(function(){var e=$(this);e.toggleClass("dm14"),e.hasClass("dm14")?e.find(".dm23").find("button").html('<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-dash-lg" viewBox="0 0 16 16">\n<path d="M0 8a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1z">\n</path>\n</svg>'):e.find(".dm23").find("button").html('<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">\n<path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"></path>\n</svg>'),$("#nav-target").find('[data-toggle="collapse"]').each((function(){e[0]!=$(this)[0]&&($(this).removeClass("dm14"),$(this).find(".dm23").find("button").html('<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">\n<path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"></path>\n</svg>'))}))})),function(){var e=$(".test_type_auction_timeout"),t=$(".test_type_client_server"),a=$(".test_type_user_id_module"),i=$(".test_type_dynamic_hard_price_floor"),n=$("#tab-setup"),s=$("#tab-target");switch($("#test_type").val()){case"1":t.addClass("d-none"),a.addClass("d-none"),i.addClass("d-none"),e.removeClass("d-none"),s.removeClass("d-none");break;case"2":e.addClass("d-none"),a.addClass("d-none"),i.addClass("d-none"),t.removeClass("d-none"),s.removeClass("d-none");break;case"3":e.addClass("d-none"),t.addClass("d-none"),i.addClass("d-none"),a.removeClass("d-none"),s.removeClass("d-none");break;case"4":e.addClass("d-none"),t.addClass("d-none"),a.addClass("d-none"),i.removeClass("d-none"),n.click(),s.addClass("d-none")}}(),function(o,l){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=$("#"+o);function c(){var o=$(".submit"),c=o.text(),p="Loading...",_=r.serializeObject();_.listData=e.list_selected,_.listGeo=n.list_selected,_.listDevice=s.list_selected,_.listAdtag=t.list_selected,_.listAdFormat=a.list_selected,_.listAdSize=i.list_selected,_.id=parseInt(_.id),_.test_type=parseInt(_.test_type),_.select_bidder=parseInt(_.select_bidder),_.select_user_id_module=parseInt(_.select_user_id_module),_.test_group_size=parseInt(_.test_group_size),_.dynamic_floor_price=parseInt(_.dynamic_floor_price),_.hard_price_floor=parseFloat(_.hard_price_floor),"on"===_.status?_.status=1:_.status=2,$.ajax({url:d,type:"POST",dataType:"JSON",contentType:"application/json",data:JSON.stringify(_),beforeSend:function(e){o.attr("disabled",!0).text(p)},error:function(e,t){var a=AjaxErrorMessage(e,t);new AlertError("AJAX ERROR: "+a),o.attr("disabled",!1).text(c)},success:function(e){o.attr("disabled",!1).text(c)},complete:function(e){l(e.responseJSON,r)}})}r.find("input").on("edit",(function(e){var t=$(this);t.hasClass("is-invalid")&&t.removeClass("is-invalid").next(".invalid-feedback").empty()})),r.find("textarea").on("edit",(function(e){var t=$(this);t.hasClass("is-invalid")&&t.removeClass("is-invalid").next(".invalid-feedback").empty()})),r.find(".selectpicker").on("change",(function(e){var t=$(this);t.closest(".box-selectpicker").hasClass("is-invalid")&&t.closest(".box-selectpicker").removeClass("is-invalid").next(".invalid-feedback").empty()})),$(r).on("keypress","input",(function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),c())})),r.find(".submit").on("click",(function(e){e.preventDefault(),c()}))}("submitAbTesting",b,"/ab-testing/edit"),$("#test_type").on("change",(function(){var e=$(".test_type_auction_timeout"),t=$(".test_type_client_server"),a=$(".test_type_user_id_module"),i=$(".test_type_dynamic_hard_price_floor"),n=$("#tab-setup"),s=$("#tab-target");switch($(this).val()){case"1":t.addClass("d-none"),a.addClass("d-none"),i.addClass("d-none"),e.removeClass("d-none"),s.removeClass("d-none");break;case"2":e.addClass("d-none"),a.addClass("d-none"),i.addClass("d-none"),t.removeClass("d-none"),s.removeClass("d-none");break;case"3":e.addClass("d-none"),t.addClass("d-none"),i.addClass("d-none"),a.removeClass("d-none"),s.removeClass("d-none");break;case"4":e.addClass("d-none"),t.addClass("d-none"),a.addClass("d-none"),i.removeClass("d-none"),n.click(),s.addClass("d-none")}})),(o=$("input.daterangepickers")).daterangepicker({autoUpdateInput:!1,singleDatePicker:!0,opens:"left"},(function(e,t,a){console.log("A new date selection was made: "+e.format("YYYY-MM-DD")+" to "+t.format("YYYY-MM-DD"))})),o.on("apply.daterangepicker",(function(e,t){$(this).val(t.startDate.format("MM/DD/YYYY"))})),o.on("cancel.daterangepicker",(function(e,t){$(this).val("")}))}));var e={idSelect:"#list_inventory",idBox:".box_inventory",idIsMoreData:"#is_more_inventory",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_inventory",urlAjax:"/target/loadInventory",optionAjax:"domain",filterAjax:[],list_selected:[],btnInclude:"add_inventory",btnRemove:"remove_inventory",idEmpty:"empty_ad_domain",text:"#text_for_domain",btnRemoveAll:"remove_all_domain",btnSelectAll:"select_all_domain",block:".block_domain",container:".container_domain",boxEmpty:"box_empty_domain",checkLoadMore:!1},t={idSelect:"#list_ad_tag",idBox:".box_ad_tag",idIsMoreData:"#is_more_tag",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_ad_tag",urlAjax:"/target/loadInventory",optionAjax:"adtag",filterAjax:[],list_selected:[],btnInclude:"add_tag",btnRemove:"remove_tag",idEmpty:"empty_ad_tag",text:"#text_for_tag",btnRemoveAll:"remove_all_tag",btnSelectAll:"select_all_tag",block:".block_tag",container:".container_tag",boxEmpty:"box_empty_tag",checkLoadMore:!1},a={idSelect:"#list_ad_format",idBox:".box_ad_format",idIsMoreData:"#is_more_adformat",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_ad_format",urlAjax:"/target/loadInventory",optionAjax:"adformat",filterAjax:[],list_selected:[],btnInclude:"add_format",btnRemove:"remove_adFormat",idEmpty:"empty_ad_format",text:"#text_for_format",btnRemoveAll:"remove_all_format",btnSelectAll:"select_all_format",block:".block_format",container:".container_format",boxEmpty:"box_empty_format",checkLoadMore:!1},i={idSelect:"#list_ad_size",idBox:".box_ad_size",idIsMoreData:"#is_more_adsize",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_ad_size",urlAjax:"/target/loadInventory",optionAjax:"adsize",filterAjax:[],list_selected:[],btnInclude:"add_size",btnRemove:"remove_adSize",idEmpty:"empty_ad_size",text:"#text_for_size",btnRemoveAll:"remove_all_size",btnSelectAll:"select_all_size",block:".block_size",container:".container_size",boxEmpty:"box_empty_size",checkLoadMore:!1},n={idSelect:"#list_geography",idBox:".box_geography",idIsMoreData:"#is_more_geography",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_geography",urlAjax:"/target/loadInventory",optionAjax:"geography",list_selected:[],btnInclude:"add_country",btnRemove:"remove_Geo",idEmpty:"empty_ad_geo",text:"#text_for_geo",btnRemoveAll:"remove_all_geo",btnSelectAll:"select_all_geo",block:".block_geo",container:".container_geo",boxEmpty:"box_empty_geo",checkLoadMore:!1},s={idSelect:"#list_device",idBox:".box_device",idIsMoreData:"#is_more_device",isMoreData:!0,lastPage:!1,page:2,isSearch:!1,search:"",idSearch:"#search_device",urlAjax:"/target/loadInventory",optionAjax:"device",list_selected:[],list_original:[],btnInclude:"add_device",btnRemove:"remove_device",idEmpty:"empty_ad_device",text:"#text_for_device",btnRemoveAll:"remove_all_device",btnSelectAll:"select_all_device",block:".block_device",container:".container_device",boxEmpty:"box_empty_device",checkLoadMore:!1},o={inventory:[],format:[],size:[]};function l(n){!function(n){$(n.idBox).find("."+n.btnRemove).each((function(s,l){var d=parseInt(l.id),r=l.name;switch(n.list_selected.push({id:d,name:r}),n){case e:o.inventory.push(d);break;case a:o.format.push(d);break;case i:o.size.push(d);break;case t:t.filterAjax.push(d)}})),x(n)}(n),d(n),function(n){$(n.idSelect).on("click","button."+n.btnInclude,(function(e){!function(e,a,i){a.preventDefault();var n=parseInt(e.data("id")),s=e.attr("name");$(i.idSelect).find("div[id = '".concat(n,"']")).remove(),h(n,s,i),v(n,-1,i),i.optionAjax!==t.optionAjax&&m()}($(this),e,n),function(e){350===$(e.idSelect).get(0).scrollHeight&&e.isMoreData&&(e.search=$(e.idSearch).val(),e.isSearch=!1,p(e))}(n),c(n),$(this).hasClass("add_inventory")&&$(".domain-card").removeClass("domain-card-invalid")})),$(n.idSearch).on("keyup keypress",(function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1})),$(n.idSearch).on("input",(function(){n.page=1,n.isSearch=!0,n.lastPage=!1,n.search=$(this).val(),p(n),r(n)})),$(n.block).on("click","a."+n.btnRemoveAll,(function(s){s.preventDefault(),function(n){n.list_selected.map((function(e){f(e.id,e.name,n)})),n.list_selected.map((function(s){switch(n.optionAjax){case e.optionAjax:var l=o.inventory.indexOf(s.id);l>-1&&o.inventory.splice(l,1),t.page=1,t.isSearch=!0,p(t);break;case a.optionAjax:var d=o.format.indexOf(s.id);d>-1&&o.format.splice(d,1),t.page=1,t.isSearch=!0,p(t);break;case i.optionAjax:var r=o.size.indexOf(s.id);r>-1&&o.size.splice(r,1),t.page=1,t.isSearch=!0,p(t);break;case t.optionAjax:var c=t.filterAjax.indexOf(s.id);c>-1&&t.filterAjax.splice(c,1)}})),n.list_selected=[],$(n.idSelect).html(""),n.page=1,n.isSearch=!1,n.isMoreData=!0,p(n),d(n),x(n)}(n)})),$(n.idBox).on("click","button."+n.btnRemove,(function(s){!function(n,s,l){s.preventDefault();var d=parseInt(n.attr("id")),r=n.attr("name");switch(n.closest(".item_selected").remove(),f(d,r,l),h(d,r,l),l.optionAjax){case e.optionAjax:var c=o.inventory.indexOf(d);c>-1&&o.inventory.splice(c,1),t.page=1,t.isSearch=!0,p(t);break;case a.optionAjax:var _=o.format.indexOf(d);_>-1&&o.format.splice(_,1),t.page=1,t.isSearch=!0,p(t);break;case i.optionAjax:var v=o.size.indexOf(d);v>-1&&o.size.splice(v,1),t.page=1,t.isSearch=!0,p(t);break;case t.optionAjax:var m=t.filterAjax.indexOf(d);m>-1&&t.filterAjax.splice(m,1)}}($(this),s,n),c(n)}))}(n),r(n)}function d(e){if(0===e.list_selected.length)$(e.idBox).html(""),$(e.idBox).append('<div id="'.concat(e.idEmpty,'" class="d-flex flex-row align-items-center px-md-2" style="height: 25px">\n            <div class="col p-0"><h6\n                        class="m-0 font-weight-semibold fs-12 text-center">\n                    No data selected</h6></div>\n        </div>'));else{$("."+e.btnRemoveAll).attr("hidden",!1);var t="#"+e.idEmpty;$(t).remove()}}function r(e){$(e.idSelect).on("scroll",(function(){var t=$(this).get(0),a=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e+t+1>=a}(Math.round(t.scrollTop),t.clientHeight,t.scrollHeight);a&&e.isMoreData&&(e.search=$(e.idSearch).val(),e.isSearch=!1,e.checkLoadMore||p(e))}))}function c(e){var t=$(e.idSelect).find("div.target-item"),a=$("."+e.boxEmpty);t.length>0?a.length>0&&a.attr("hidden",!0):a.length>0?a.attr("hidden",!1):$(e.idSelect).append('<div class="list-group list-group-flush my-n3 pt-3 '.concat(e.boxEmpty,'">\n                <div class="list-group-item">\n                    <div class="d-flex flex-row align-items-center px-md-2">\n                        <div class="col p-0 text-center"><h6 class="m-0 font-weight-semibold fs-12">No data available</h6></div>\n                    </div>\n                </div>\n            </div>'))}function p(e){var a;e.checkLoadMore=!0,a=0===e.page?e.page+1:e.page;var i=[];e.list_selected.map((function(e){i.push(e.id)})),$.ajax({url:e.urlAjax,type:"GET",data:{key:a,search:e.search,option:e.optionAjax,filter:JSON.stringify(o),selected:JSON.stringify(i)},success:function(a){e.isSearch&&$(e.idSelect).html(""),$(e.idSelect).append(a.data),e.isMoreData=a.is_more_data,$(e.idIsMoreData).val(a.is_more_data),!0===a.is_more_data&&(e.page=a.current_page+1),e.checkLoadMore=!1,e.lastPage=a.last_page,g(e),function(e,a){if(e.optionAjax===t.optionAjax){var i=[];t.list_selected.map((function(e,n){-1===a.indexOf(e.id)&&($(t.idBox).find("div[id = '".concat(e.id,"']")).remove(),i.push(n))}));for(var n=i.length-1;n>=0;n--)t.list_selected.splice(i[n],1);var s=[];$.each(t.filterAjax,(function(e,t){-1===a.indexOf(t)&&s.push(e)}));for(var o=s.length-1;o>=0;o--)t.filterAjax.splice(s[o],1);d(t)}}(e,a.list_filter),x(e),function(e,t,a){t<7&&1===a||(e.lastPage||t>7||0===t)&&($("."+e.boxEmpty).remove(),$(e.idSelect).append('<div class="list-group list-group-flush my-n3 pt-3 '.concat(e.boxEmpty,'">\n        <div class="list-group-item">\n            <div id="').concat(e.idEmptyLoad,'" class="d-flex flex-row align-items-center px-md-2">\n                <div class="col p-0 text-center"><h6 class="m-0 font-weight-semibold fs-12">No data available</h6></div>\n            </div>\n        </div>\n    </div>')))}(e,a.total,a.current_page)},error:function(e){console.log(e)}})}function _(t,n){$.ajax({url:"/target/filterAdTag",type:"POST",contentType:"application/json",data:JSON.stringify({type:n,tagId:t.filterAjax,serverType:parseInt($("#server_type").val())}),success:function(t){!function(t){var n;t.inventory_id.map((function(t){var a=(n=e).list_selected.map((function(e){return e.id})).indexOf(t.id);-1===a&&(n.list_selected.push({id:t.id,name:t.name}),u(t.id,t.name,n)),g(n),x(n),d(n),v(t.id,a,n)})),t.ad_format_id.map((function(e){var t=(n=a).list_selected.map((function(e){return e.id})).indexOf(e.id);-1===t&&(n.list_selected.push({id:e.id,name:e.name}),u(e.id,e.name,n)),g(n),x(n),d(n),v(e.id,t,n)})),t.ad_size_id.map((function(e){var t=(n=i).list_selected.map((function(e){return e.id})).indexOf(e.id);-1===t&&(n.list_selected.push({id:e.id,name:e.name}),u(e.id,e.name,n)),g(n),x(n),d(n),v(e.id,t,n)})),m()}(t)},error:function(e){console.log(e)}})}function v(n,s,l){switch(l.optionAjax){case e.optionAjax:-1===s&&o.inventory.push(n);break;case a.optionAjax:-1===s&&o.format.push(n);break;case i.optionAjax:-1===s&&o.size.push(n);break;case t.optionAjax:t.filterAjax.push(n),_(t,"include")}}function m(){t.page=1,t.isSearch=!0,p(t)}function h(e,t,a){var i=a.list_selected.map((function(e){return e.id})).indexOf(e);-1===i?(a.list_selected.push({id:e,name:t}),u(e,t,a)):a.list_selected.splice(i,1),x(a),d(a)}function f(e,t,a){$(a.idSelect).append('\n    <div class="dm20 target-item" id="'.concat(e,'">\n        <span>').concat(t,'</span>\n        <button class="').concat(a.btnInclude,'" data-id="').concat(e,'" name="').concat(t,'" type="button">\n            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">\n                <path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"></path>\n            </svg>\n        </button>\n    </div>'))}function u(e,t,a){$(a.idBox).append('\n        <div class="dm20 target-item item_selected" id="'.concat(e,'">\n            <span>').concat(t,'</span>\n            <button class="').concat(a.btnRemove,'" id="').concat(e,'" name="').concat(t,'" type="button">\n                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-dash-lg" viewBox="0 0 16 16">\n                    <path d="M0 8a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1z"></path>\n                </svg>\n            </button>\n        </div>'))}function g(e){e.list_selected.map((function(t){$(e.idSelect).find("div[id = '".concat(t.id,"']")).remove()}))}function x(o){var l=o.list_selected.map((function(e){return" ".concat(e.name)})).join(),d=l.length;if(d>40){$(o.text).prev().attr("hidden",!0);var r=l.substring(0,39);$(o.text).html(r+"....")}else if(d>0)$(o.text).prev().attr("hidden",!0),$(o.text).html(l);else switch($(o.text).prev().removeAttr("hidden"),o){case e:$(o.text).html("all domains");break;case a:$(o.text).html("all formats");break;case i:$(o.text).html("all sizes");break;case t:$(o.text).html("all ad tags");break;case n:$(o.text).html("all geographies");break;case s:$(o.text).html("all devices")}}function b(e,t){switch(e.status){case"error":1===e.errors.length&&""===e.errors[0].id?new AlertError(e.errors[0].message):e.errors.length>0?($.each(e.errors,(function(e,t){var a=$("#"+t.id);a.addClass("is-invalid").nextAll("span.invalid-feedback").text(t.message),a.closest(".box-selectpicker").addClass("is-invalid").nextAll("span.invalid-feedback").text(t.message)})),$("#"+e.errors[0].id).focus(),$("#"+e.errors[0].id).prev("label").focus()):new AlertError("Error!");break;case"success":NoticeSuccess("A/B Testing has been updated successfully");break;default:new AlertError("Undefined")}}$(document).ready((function(){e.isMoreData="true"===$("#is_more_inventory").val(),e.lastPage="true"===$("#last_page_domain").val(),a.isMoreData="true"===$("#is_more_adformat").val(),a.lastPage="true"===$("#last_page_format").val(),i.isMoreData="true"===$("#is_more_adsize").val(),i.lastPage="true"===$("#last_page_size").val(),t.isMoreData="true"===$("#is_more_tag").val(),t.lastPage="true"===$("#last_page_tag").val(),n.isMoreData="true"===$("#is_more_geography").val(),n.lastPage="true"===$("#last_page_geo").val(),s.isMoreData="true"===$("#is_more_device").val(),s.lastPage="true"===$("#last_page_device").val(),l(e),l(t),l(a),l(i),l(n),l(s),m()}))})();