(()=>{function e(){$(".list_params").find(".selectpicker").selectpicker()}function a(a){$.ajax({url:"/bidder/addTemplate",type:"GET",data:{id:a},success:function(a){var d=$(".list_params");d.html(""),d.prepend(a.params),$("#media_type").val(a.list_media_type).trigger("change"),e()},error:function(e){console.log(e)}})}function d(e,a){switch(e.status){case"error":1===e.errors.length&&""===e.errors[0].id?new AlertError(e.errors[0].message):e.errors.length>0?($.each(e.errors,(function(e,a){var d=$("#"+a.id);d.addClass("is-invalid").nextAll("span.invalid-feedback").text(a.message),d.next().find(".select2-selection").addClass("select2-is-invalid"),d.closest(".box-select2").addClass("is-invalid").nextAll("span.invalid-feedback").text(a.message),d.next(".dropdown-toggle").removeClass("btn-light").addClass("select2-is-invalid"),d.closest(".box-selectpicker").addClass("is-invalid").nextAll("span.invalid-feedback").text(a.message),d.find(".param_name").addClass("is-invalid")})),$("#"+e.errors[0].id).focus(),$("#"+e.errors[0].id).prev("label").focus()):new AlertError("Error!");break;case"success":NoticeSuccess("Bidder has been updated successfully");break;default:new AlertError("Undefined")}}$(document).ready((function(){$('[data-bs-toggle="popover"]').popover({html:!0,sanitize:!1}),function(){var e=$("#select-bidder").val(),a=new Option("Native","3",!1,!1);if("1"===e){$(".btn-add-param").addClass("disabled"),$(".bidder-amz").addClass("d-none"),$(".bidder-google").removeClass("d-none"),$("#media_type").prop("disabled",!1),$("#media_type option[value='3']").remove(),$("#media_type").selectpicker("refresh"),$("#pub_id_des_amz").addClass("d-none"),$("#pub_id_des_google").removeClass("d-none");var d=$(".list_params");d.html(""),d.prepend('\n    <div class="text-white m-2">No Param</div>\n'),$(".box-params").addClass("d-none")}else"2"===e?($(".box-params").removeClass("d-none"),$(".btn-add-param").addClass("disabled"),$(".bidder-google").addClass("d-none"),$("#media_type").prop("disabled",!1),$("#media_type").find("option[value='3']").length||$("#media_type").append(a).trigger("change"),$("#media_type").selectpicker("refresh"),$(".bidder-amz").removeClass("d-none"),$("#pub_id_des_google").addClass("d-none"),$("#pub_id_des_amz").removeClass("d-none")):($(".box-params").removeClass("d-none"),$(".btn-add-param").removeClass("disabled"),$(".bidder-amz").addClass("d-none"),$(".bidder-google").addClass("d-none"),$("#media_type").prop("disabled",!0),$("#media_type").find("option[value='3']").length||$("#media_type").append(a).trigger("change"),$("#media_type").selectpicker("refresh"))}(),function(e,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=$("#"+e);s.find("input").on("input",(function(e){var a=$(this);a.hasClass("is-invalid")&&(a.removeClass("is-invalid").next(".invalid-feedback").empty(),a.closest(".param").removeClass("is-invalid").next(".invalid-feedback").empty())})),s.find("textarea").on("input",(function(e){var a=$(this);a.hasClass("is-invalid")&&a.removeClass("is-invalid").next(".invalid-feedback").empty()})),s.find(".select2").on("select2:open",(function(){var e=$(this);e.next().find(".select2-selection").hasClass("select2-is-invalid")&&(e.next().find(".select2-selection").removeClass("select2-is-invalid"),e.removeClass("is-invalid").next(".invalid-feedback").empty(),e.closest(".box-select2").next(".invalid-feedback").empty())})),s.find(".selectpicker").on("change",(function(){var e=$(this);e.next(".dropdown-toggle").hasClass("select2-is-invalid")&&(e.next(".dropdown-toggle").addClass("btn-light").removeClass("select2-is-invalid"),e.removeClass("is-invalid").next(".invalid-feedback").empty(),e.closest(".box-selectpicker").next(".invalid-feedback").empty())})),s.find(".submit").on("click",(function(e){e.preventDefault();var i,n=$(this),t=n.text(),l="Loading...",r=s.serializeObject();r.id=parseInt(r.id),r.bidder_id=parseInt($("#select-bidder").val()),r.media_type=$("#media_type").val(),r.bid_adjustment=parseFloat(r.bid_adjustment),r.linked_gam=parseInt(r.linked_gam),r.account_type=parseInt(r.account_type),r.rpm=parseFloat(r.rpm),r.params=(i=[],$(".list_params").find(".param_value").each((function(){if($(this).val()){var e={};e.name=$(this).val(),e.type=$(this).find(":selected").data("type"),i.push(e)}})),i),$.ajax({url:d,type:"POST",dataType:"JSON",contentType:"application/json",data:JSON.stringify(r),beforeSend:function(e){n.attr("disabled",!0).text(l)},error:function(e,a){var d=AjaxErrorMessage(e,a);new AlertError("AJAX ERROR: "+d),n.attr("disabled",!1).text(t)},success:function(e){n.attr("disabled",!1).text(t)},complete:function(e){a(e.responseJSON,s)}})}))}("submitBidder",d),$(".btn-add-param").click((function(){$(".list_params").append($(".box-param-default").html()),function(a){$.ajax({url:"/bidder/addParam",type:"GET",data:{demand:a.trim()},success:function(a){$(".list_params").append(a),e()},error:function(e){console.log(e)}})}($("#select-bidder").find(":selected").text()),e()})),$(".list_params").on("click",".btn-remove-param",(function(){$(this).closest(".box-param").remove()})),$(".list_params").on("input",".param-add .param .param_name",(function(){var e=$(this);e.hasClass("is-invalid")&&(e.removeClass("is-invalid"),e.closest(".param").removeClass("is-invalid").next(".invalid-feedback").empty())})),$("#select-bidder").on("change",(function(){0;var e=new Option("Native","3",!1,!1);if("1"===$(this).val()){$(".btn-add-param").addClass("disabled"),$(".bidder-amz").addClass("d-none"),$(".bidder-google").removeClass("d-none"),$("#media_type").prop("disabled",!1),$("#media_type option[value='3']").remove(),$("#media_type").selectpicker("refresh"),$("#pub_id_des_amz").addClass("d-none"),$("#pub_id_des_google").removeClass("d-none");var d=$(".list_params");d.html(""),d.prepend('\n    <div class="text-white m-2">No Param</div>\n'),$(".box-params").addClass("d-none")}else"2"===$(this).val()?($(".box-params").removeClass("d-none"),$(".btn-add-param").addClass("disabled"),$(".bidder-google").addClass("d-none"),$("#media_type").prop("disabled",!1),$("#media_type").find("option[value='3']").length||$("#media_type").append(e).trigger("change"),$("#media_type").selectpicker("refresh"),$(".bidder-amz").removeClass("d-none"),$("#pub_id_des_google").addClass("d-none"),$("#pub_id_des_amz").removeClass("d-none"),a($(this).val())):($(".box-params").removeClass("d-none"),$(".btn-add-param").removeClass("disabled"),$(".bidder-amz").addClass("d-none"),$(".bidder-google").addClass("d-none"),$("#media_type").prop("disabled",!0),$("#media_type").find("option[value='3']").length||$("#media_type").append(e).trigger("change"),$("#media_type").selectpicker("refresh"),a($(this).val()))}))}))})();