(()=>{var e=[".jpg",".jpeg",".bmp",".gif",".png"],n="https://ul.pubpowerplatform.io",s=1;function t(){"2"===$("#content_type").val()?($(".box-answer-quiz2").addClass("d-none"),$(".box-answer-quiz1").removeClass("d-none")):($(".box-answer-quiz1").addClass("d-none"),$(".box-answer-quiz2").removeClass("d-none"))}function a(e){var n=1;$(".list-questions > div.box-c > div.question-box").each((function(s,t){var a="<span class='ms-3'> QUESTION "+n+"</span>";if($(this).find(".lb-question").html(a),$(this).closest(".question-item").attr("data-question",n),void 0!==e){var i=e.questions[s].id;$(this).closest(".question-item").find(".question-id").val(i)}var r=!1,l=1;$(this).find(".box-answer-quiz1 .answer-item").each((function(t,a){var i="Answer "+l;$(this).find(".answer-name").html(i),$(this).attr("data-answer",l);var o="quiz1_question_"+n+"_answer_"+l;if($(this).find(".answer-correct").attr("id",o),$(this).find(".answer-name").attr("for",o),void 0!==e){var d=e.questions[s].answers[t].id;$(this).find(".answer-id").val(d)}r||(r=$(this).find(".answer-correct").is(":checked")),l++})),r||$(this).find(".box-answer-quiz1 .answer-item[data-answer=1] .answer-correct").prop("checked",!0);var o=!1,d=1;$(this).find(".box-answer-quiz2 .answer-item").each((function(t,a){var i="Answer "+d;$(this).find(".answer-name").html(i),$(this).attr("data-answer",d);var r="quiz2_question_"+n+"_answer_"+d;if($(this).find(".answer-correct").attr("id",r),$(this).find(".answer-name").attr("for",r),void 0!==e){var l=e.questions[s].answers[t].id;$(this).find(".answer-id").val(l)}o||(o=$(this).find(".answer-correct").is(":checked")),d++})),o||$(this).find(".box-answer-quiz2 .answer-item[data-answer=1] .answer-correct").prop("checked",!0),n++}))}function i(){var e=[],n=$("#content_type").val();return $(".list-questions .question-item").each((function(){var s={};s.id=parseInt($(this).find(".question-id").val()),s.question=$(this).find(".text_question").val(),s.background=$(this).find("#background").val();var t=[];"2"===n?$(this).find(".box-answer-quiz1 .answer-item").each((function(){var e={};e.id=parseInt($(this).find(".answer-id").val()),e.correct=$(this).find(".answer-correct").is(":checked"),e.text=$(this).find(".text_answer").val(),t.push(e)})):$(this).find(".box-answer-quiz2 .answer-item").each((function(){var e={};e.id=parseInt($(this).find(".answer-id").val()),e.correct=$(this).find(".answer-correct").is(":checked"),e.text=$(this).find(".text_answer").val(),e.img=$(this).find(".show-image-answer").attr("data-link"),t.push(e)})),s.answer=t,e.push(s)})),e}function r(e,n){switch(e.status){case!1:1===e.errors.length&&""===e.errors[0].id?new AlertError(e.errors[0].message):e.errors.length>0?($.each(e.errors,(function(e,n){var s=$("#"+n.id);s.addClass("is-invalid").nextAll("span.invalid-feedback").text(n.message),s.next().find(".select2-selection").addClass("select2-is-invalid")})),$("#"+e.errors[0].id).focus(),$("#"+e.errors[0].id).prev("label").focus()):new AlertError("Error!");break;case!0:NoticeSuccess("Quiz has been created successfully"),setTimeout((function(){window.location.replace("/quiz")}),1e3);break;default:new AlertError("Undefined")}}function l(e,s){var t=new FormData,a=e.target.files[0];a.size>15728640?new AlertError("You uploaded file over 10mb, please choose another file!"):(t.append("file",a),$.ajax({url:"https://ul.pubpowerplatform.io/api/v1/image",type:"POST",contentType:!1,processData:!1,data:t,beforeSend:function(e){},error:function(e,n){var s=AjaxErrorMessage(e,n);new AlertError("AJAX ERROR: "+s)},success:function(e){},complete:function(e){!function(e,s){switch(e.status){case"error":1===e.errors.length&&""===e.errors[0].id?new AlertError(e.errors[0].message):e.errors.length>0?($.each(e.errors,(function(e,n){$("#"+n.id).addClass("is-invalid").nextAll("span.invalid-feedback").text(n.message)})),new AlertError(e.errors[0].message)):new AlertError("Error!");break;case"success":$(s).prev(".show-image-answer").attr("src",n+e.data_object.thumb[0]).attr("data-link",e.data_object.thumb[0]),$(s).attr("value",e.data_object.thumb[0]),s.hasClass("upload_background")&&(s.closest(".question-item").find(".background").val(e.data_object.thumb[0]),s.closest(".question-item").find(".show-background").attr("src",n+e.data_object.thumb[0])),s.hasClass("upload_illustration")&&(s.closest(".box-illustration").find(".illustration").val(e.data_object.thumb[0]),s.closest(".box-illustration").find(".show-illustration").attr("src",n+e.data_object.thumb[0]));break;default:new AlertError("Undefined")}}(e.responseJSON,s)}}))}function o(e,n,s){var t=e[0];if("file"===t.type){var a=t.value;if(a.length>0){for(var i=!1,r=0;r<n.length;r++){var o=n[r];if(a.substr(a.length-o.length,o.length).toLowerCase()===o.toLowerCase()){i=!0,l(s,e);break}}if(!i)return new AlertError("Sorry, "+a+" is invalid, allowed extensions are: "+n.join(", ")),!1}}return!0}$(document).ready((function(){a(),$(".btn-add-question").on("click",(function(){var e;$(".list-questions").append('\n        <div class="box-c question-item" data-question="0">\n            <input type="hidden" class="question-id" value="">\n            <hr class="mt-3 hr_custom bg-gray-400" style="margin: 0 -20px 0 -50px !important;">\n            <div class="question-box">\n                <div class="d-flex align-items-center question">\n                    <label class="col-form-label form-label form-label-lg w-input-group text-uppercase lb-question"><span\n                                class="ms-3">QUESTION 1</span></label>\n                    <a class="btn p-1 ms-2 remove-question">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="currentColor"\n                             class="bi bi-x-lg" viewBox="0 0 16 16">\n                            <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"></path>\n                        </svg>\n                    </a>\n                </div>\n                \n                <div class="pp15">\n                    <div class="pt2">Question</div>\n                </div>\n                <div class="pp7">\n                    <div class="pp-9">\n                        <input class="pp-10 form-control text_question" type="text">\n                        <span class="form-text ms-2 w-auto invalid-feedback"></span>\n                    </div>\n                </div>\n                \n                <div class="pp15">\n                    <div class="pt2">Background</div>\n                </div>\n                <div class="pp7">\n                    <div class="box-upload-thumb w-100" >\n                        <input type="file" id="upload_background'+(e=s)+'" name="upload_background" class="d-none upload_background" title="Choose a background please" aria-describedby="thumb" aria-label="Upload" accept="image/*">\n                        <div class="d-flex" id="box-upload-thumb">\n                            <label class="pp-11 mb-0" for="upload_background'+e+'" style="max-width: 100px;min-width: 100px;border-right: 0;border-left: 1px solid #aab4c8;">Choose file</label>\n                            <input class="pp10 w-100 background" id="background" name="background" type="text" value="" readonly style="border-top-left-radius: 0;border-bottom-left-radius: 0;cursor: not-allowed;">\n                        </div>\n                        <span class="form-text ms-2 w-auto invalid-feedback"></span>\n                    </div>\n                </div>\n                <div class="pp7">\n                    <div class="preview-image-answer d-flex justify-content-center">\n                        <img class="show-background" src="" data-link="" style="height: 92px">\n                    </div>\n                    <span class="ms-2 text_answer" style="height: 92px;max-height: 92px; width: 100%;padding: 10px"></span>\n                </div>\n\n                <div class="box-answer box-answer-quiz1">\n                    <div class="answer-item" data-answer="0">\n                        <input type="hidden" class="answer-id" value="">\n                        <div class="pp15">\n                            <div class="m-0 d-flex align-items-center justify-content-center" style="height: 15px; width: 15px">\n                                <input class="m-0 answer-correct" type="checkbox" checked="checked" value="" id="" style="height: 15px; width: 15px;cursor: pointer;border-color: #ced4da;">\n                            </div>\n                            <label class="pt2 answer-name ms-2" for="">Answer 0</label>\n                        </div>\n                        <div class="pp7">\n                            <div class="w-100">\n                                <input style="border-right: 0;" type="text" class="pp-10 text_answer">\n                                <span class="form-text ms-2 w-auto invalid-feedback"></span>\n                            </div>\n                            <a href="javascript:void(0)" class="dg1 btn-remove-answer" title="Remove Answer">\n                                <svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: initial;" width="15"\n                                     height="15" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">\n                                    <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"></path>\n                                </svg>\n                            </a>\n                        </div>\n                    </div>\n                    <div class="answer-item" data-answer="0">\n                        <input type="hidden" class="answer-id" value="">\n                        <div class="pp15">\n                            <div class="m-0 d-flex align-items-center justify-content-center" style="height: 15px; width: 15px">\n                                <input class="m-0 answer-correct" type="checkbox" value="" id="" style="height: 15px; width: 15px;cursor: pointer;border-color: #ced4da;">\n                            </div>\n                            <label class="pt2 answer-name ms-2" for="">Answer 0</label>\n                        </div>\n                        <div class="pp7">\n                            <div class="w-100">\n                                <input style="border-right: 0;" type="text" class="pp-10 text_answer">\n                                <span class="form-text ms-2 w-auto invalid-feedback"></span>\n                            </div>\n                            <a href="javascript:void(0)" class="dg1 btn-remove-answer" title="Remove Answer">\n                                <svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: initial;" width="15"\n                                     height="15" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">\n                                    <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"></path>\n                                </svg>\n                            </a>\n                        </div>\n                    </div>\n                </div>\n                <div class="pp7 box-answer-quiz1">\n                    <a class="pt98 btn-add-answer-quiz1">Add Answer</a>\n                </div>\n\n                <div class="box-answer box-answer-quiz2">\n                    <div class="answer-item" data-answer="1">\n                        <input type="hidden" class="answer-id" value="">\n                        <div class="pp15">\n                            <div class="m-0 d-flex align-items-center justify-content-center" style="height: 15px; width: 15px">\n                                <input class="answer-correct m-0" type="checkbox" checked="checked" value="" id="" style="height: 15px; width: 15px">\n                            </div>\n                            <label class="pt2 answer-name ms-2" for="">Answer 1</label>\n                        </div>\n                        <div class="pp7">\n                            <div class="preview-image-answer d-flex justify-content-center">\n                                <img class="show-image-answer" src="" data-link="" style="height: 92px">\n                                <input type="file" class="d-none link logo" value="">\n                            </div>\n                            <textarea class="ms-2 text_answer" type="text"\n                                      style="height: 92px;max-height: 92px; width: 100%;padding: 10px"></textarea>\n                        </div>\n                        <div class="pp7">\n                            <a class="pt98 btn-add-logo logo-config">ADD</a>\n                        </div>\n                    </div>\n                    <div class="answer-item" data-answer="2">\n                        <input type="hidden" class="answer-id" value="">\n                        <div class="pp15">\n                            <div class="m-0 d-flex align-items-center justify-content-center" style="height: 15px; width: 15px">\n                                <input class="answer-correct m-0" type="checkbox" value="" id="" style="height: 15px; width: 15px">\n                            </div>\n                            <label class="pt2 answer-name ms-2" for="">Answer 2</label>\n                        </div>\n                        <div class="pp7" data-answer="2">\n                            <div class="preview-image-answer d-flex justify-content-center">\n                                <img class="show-image-answer" src="" data-link="" style="height: 92px">\n                                <input type="file" class="d-none link logo" value="">\n                            </div>\n                            <textarea class="ms-2 text_answer" type="text"\n                                      style="height: 92px;max-height: 92px; width: 100%;padding: 10px"></textarea>\n                        </div>\n                        <div class="pp7">\n                            <a class="pt98 btn-add-logo logo-config">ADD</a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    '),$(".selectpicker").selectpicker("refresh"),a(),t(),s++})),$(".list-questions").on("click",".box-c .remove-question",(function(){$(this).closest(".box-c").remove(),a()})),$(".list-questions").on("click",".box-c .btn-add-answer-quiz1",(function(){var e=0;$(this).parent().prev(".box-answer-quiz1").find(".answer-item").each((function(){e++})),e<4&&($(this).parent().prev(".box-answer-quiz1").append('\n                    <div class="answer-item" data-answer="0">\n                        <input type="hidden" class="answer-id" value="">\n                        <div class="pp15">\n                            <div class="m-0 d-flex align-items-center justify-content-center" style="height: 15px; width: 15px">\n                                <input class="m-0 answer-correct" type="checkbox" value="" id="" style="height: 15px; width: 15px;cursor: pointer;border-color: #ced4da;">\n                            </div>\n                            <label class="pt2 answer-name ms-2" for="">Answer 0</label>\n                        </div>\n                        <div class="pp7">\n                            <div class="w-100">\n                                <input style="border-right: 0;" type="text" class="pp-10 text_answer">\n                                <span class="form-text ms-2 w-auto invalid-feedback"></span>\n                            </div>\n                            <a href="javascript:void(0)" class="dg1 btn-remove-answer" title="Remove Answer">\n                                <svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: initial;" width="15"\n                                     height="15" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">\n                                    <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"></path>\n                                </svg>\n                            </a>\n                        </div>\n                    </div>\n    '),a())})),$(".list-questions").on("click",".box-c .box-answer-quiz1 .btn-remove-answer",(function(){var e=0;$(this).closest(".box-answer-quiz1").find(".answer-item").each((function(){e++})),e>2&&($(this).closest(".answer-item").remove(),a())})),$(".list-questions").on("change",".box-c .answer-correct",(function(){var e;e=this,$(e).is(":checked")&&$(e).closest(".box-answer").find(".answer-correct").prop("checked",!1),$(e).prop("checked",!0)})),t(),$(".list-questions").on("click",".btn-add-logo",(function(){$(this).closest(".answer-item").find(".logo").click()})),$(".list-questions").on("change",".logo",(function(n){o($(this),e,n)})),$("#upload_illustration").on("change",(function(n){o($(this),e,n)})),function(e,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",t=$("#"+e);t.find("input").on("click change blur",(function(e){var n=$(this);n.hasClass("is-invalid")&&n.removeClass("is-invalid").next(".invalid-feedback").empty()})),t.find("textarea").on("click change blur",(function(e){var n=$(this);n.hasClass("is-invalid")&&n.removeClass("is-invalid").next(".invalid-feedback").empty()})),t.find(".select2").on("select2:open",(function(e){var n=$(this);n.next().find(".select2-selection").hasClass("select2-is-invalid")&&(n.next().find(".select2-selection").removeClass("select2-is-invalid"),n.removeClass("is-invalid").next(".invalid-feedback").empty())})),t.find(".submit").on("click",(function(e){e.preventDefault();var a=$(this),r=a.text(),l="Loading...",o=t.serializeObject();o.category=parseInt(o.category),o.content_type=parseInt(o.content_type),o.questions=i(),$.ajax({url:s,type:"POST",dataType:"JSON",contentType:"application/json",data:JSON.stringify(o),beforeSend:function(e){a.attr("disabled",!0).text(l)},error:function(e,n){var s=AjaxErrorMessage(e,n);new AlertError("AJAX ERROR: "+s),a.attr("disabled",!1).text(r)},success:function(e){a.attr("disabled",!1).text(r)},complete:function(e){n(e.responseJSON,t)}})}))}("formQuiz",r,"/content/quiz/add"),$(".quiz-tab").on("click",".nav-link",(function(){$(".quiz-tab").find(".nav-link").removeClass("pp-4"),$(this).addClass("pp-4"),"1"!=$(this).attr("data-tab")?$(this).addClass("at-1"):$(".quiz-tab").find(".at-1").removeClass("at-1")})),$("#content_type").on("change",(function(e){t()}))})),$("#nav-question").on("change",".upload_background",(function(n){o($(this),e,n)}))})();