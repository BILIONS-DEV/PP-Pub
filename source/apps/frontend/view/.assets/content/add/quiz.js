(()=>{var e=[".jpg",".jpeg",".bmp",".gif",".png"],a=[".m4v",".avi",".mpg",".mp4",".3gp"],t="https://ul.pubpowerplatform.io",n=!0,s=!0,i=!1,r=!1;function o(e){var a;return e.hasClass("pre-roll-break")?a="preroll":e.hasClass("mid-roll-break")?a="midroll":e.hasClass("post-roll-break")&&(a="postroll"),a}function d(e){var a=e.closest(".box-adtag-url"),t=a.prev(),n=a.find(".break_mode").find("option:selected").val(),s=t.attr("data-action"),i=function(e,a){var t="";switch(e){case"1":""===a?t="Invalid number":parseInt(a)<0&&(t="Number must be equal to or greater than 0");break;case"2":a.match("/^d{2,}:d{2}:d{2}$/")||(t="Please match format eg. 1:00:00.123");break;case"3":""===a?t="Invalid number":(parseInt(a)<0||parseInt(a)>100)&&(t="Number must be between 0 and 100")}return""===t?"":'<div class="wui-input__error box_error_time_break" tabindex="1" title="'.concat(t,'">').concat(t,"</div>")}(n,e.val());0===e.val().length||""!==i?("done"===s&&(t.find(".box-step-roll").removeClass().addClass("box-step-roll").addClass("_error_z87zl_157"),t.find("._inactive_iyx7e_22").removeClass("_inactive_iyx7e_22").addClass("_error_iyx7e_31")),a.prev().find(".btn-done-roll").addClass("-disabled").find("button").prop("disabled",!0),a.find(".box_time_break").addClass("-error -error-msg").find(".box_error_time_break").remove(),a.find(".box_time_break").append(i)):("done"===s&&(t.find(".box-step-roll").removeClass().addClass("box-step-roll").addClass("_editing_z87zl_152"),t.find("._error_iyx7e_31").removeClass("_error_iyx7e_31").addClass("_inactive_iyx7e_22")),a.find(".box_time_break").removeClass("-error -error-msg").find(".box_error_time_break").remove(),a.prev().find(".btn-done-roll").removeClass("-disabled").find("button").prop("disabled",!1))}function l(e){if("midroll"===e){var a=!0;$(".mid-roll-break").each((function(e){("done"!==$(this).attr("data-action")||e>8)&&(a=!1)})),a&&function(){var e=$(".mid-roll-break").last(),a=e.next();if(a.hasClass("box-adtag-url")){var t=a.next();t.hasClass("box-adtag-url-backup")?($(c("midroll")).insertAfter(t),t.next().find(".selectpicker").selectpicker("refresh")):($(c("midroll")).insertAfter(a),a.next().find(".selectpicker").selectpicker("refresh"))}else $(c("midroll")).insertAfter(e),e.next().find(".selectpicker").selectpicker("refresh")}()}}function c(e){var a="",t="";return"preroll"===e?(a="pre-roll-break",t="Preroll"):"midroll"===e?(a="mid-roll-break",t="Midroll"):"postroll"===e&&(a="post-roll-break",t="Postroll"),'\n<div class="_breakItem_z87zl_75 pp_ad_schedules_7 -orientation-horizontal -align-center -wrap hydrated w-100 box-roll '.concat(a,'">\n                    <div class="" style="padding: 20px;flex-wrap: nowrap;">\n                        <div class="box-step-roll">\n                            <div data-test="show-break-label"\n                                 class="_breakLabel_z87zl_137 pp_ad_schedules_7 -orientation-horizontal -align-center -justify-space-between -wrap hydrated">\n                                <div>\n                                    <div data-test="show-break-label-text">').concat(t,'</div>\n                                    <svg class="_stepper_iyx7e_16" width="40" height="6"\n                                         fill="none" xmlns="http://www.w3.org/2000/svg">\n                                        <circle class="').concat("preroll"===e?"_inactive_iyx7e_22":"",'" cx="3" cy="3" r="3"\n                                                data-test="show-preroll-step"></circle>\n                                        <circle class="').concat("midroll"===e?"_inactive_iyx7e_22":"",'" cx="20" cy="3"\n                                                r="3"\n                                                data-test="show-midroll-step"></circle>\n                                        <circle class="').concat("postroll"===e?"_inactive_iyx7e_22":"",'" cx="37" cy="3" r="3"\n                                                data-test="show-postroll-step"></circle>\n                                        <path stroke-width="2" d="M8 3h7M25 3h7"></path>\n                                    </svg>\n                                </div>\n                            </div>\n                        </div>\n                        <p class="_font_83r5j_16 _s_83r5j_23 _baselineShift_83r5j_42 text-adtag-url"\n                           style="font-family: \'Open Sans\',Arial,sans-serif; color: #475470;"></p>\n                        <div style="flex: 1 1 0%;"></div>\n                        <div class="wui-button -type-icon hydrated box-btn-add">\n                            <button type="button" class="btn-add-roll">\n                                <div class="wui-icon wui-icon--dashboard_add -size-m hydrated">\n                                    <svg xmlns="http://www.w3.org/2000/svg"\n                                         viewBox="0 0 24 24"\n                                         id="ds-icon-dashboard-add">\n                                        <path d="M20 10h-6V4a2 2 0 0 0-4 0v6H4a2 2 0 0 0 0 4h6v6a2 2 0 0 0 4 0v-6h6a2 2 0 0 0 0-4Z"></path>\n                                    </svg>\n                                </div>\n                            </button>\n                        </div>\n                        <div class="pp_ad_schedules_7 -orientation-horizontal -gutter-s -wrap hydrated box-btn-edit d-none">\n                            <div>\n                                <div data-test="cancel-editing-state" type="tertiary"\n                                     class="wui-button -type-tertiary hydrated btn-cancel-roll">\n                                    <button type="button"><span>Cancel</span></button>\n                                </div>\n                                <div data-test="save-break" type="secondary"\n                                     class="wui-button -type-secondary -disabled hydrated btn-done-roll">\n                                    <button type="button" disabled=""><span>Done</span>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="dropdown wui-more-menu -type-icon hydrated box-btn-action d-none">\n                            <a class="dropdown-toggle wui-button -type-icon hydrated" type="button"\n                               id="dropdownUserButton" data-toggle="dropdown"\n                               aria-haspopup="true" aria-expanded="false" title="Email of publisher">\n                                <div class="wui-icon wui-icon--dashboard_more -size-m hydrated">\n                                    <svg xmlns="http://www.w3.org/2000/svg"\n                                         viewBox="0 0 24 24"\n                                         id="ds-icon-dashboard-more">\n                                        <path d="M6 12a2 2 0 1 1-2-2 2 2 0 0 1 2 2Zm6-2a2 2 0 1 0 2 2 2 2 0 0 0-2-2Zm8 0a2 2 0 1 0 2 2 2 2 0 0 0-2-2Z"></path>\n                                    </svg>\n                                </div>\n                            </a>\n                            <div class="dropdown-menu" aria-labelledby="dropdownUserButton">\n                                ').concat("midroll"===e?'<a class="dropdown-item btn-edit-roll" type="button">Edit</a>':"",'\n                                <a class="dropdown-item text-danger btn-del-roll" type="button">Delete</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n')}function v(e,a,t){var i=new FormData,r=e.target.files[0];if(r.size>209715200)return new AlertError("You uploaded file over 10mb, please choose another file!"),$("#loading_video").addClass("d-none"),void $("#loading_thumb").addClass("d-none");switch(i.append("file",r),t){case"video":n=!1;var o=URL.createObjectURL(r);$(".preview-video").html(""),$(".preview-video").append('\n                     <video src="'.concat(o,'" style="max-height:535px;max-width: 870px; width: 100%;height: 100%;" controls="controls" type="video/mp4"></video>')),$.ajax({url:"https://ul.pubpowerplatform.io/api/v1/video",type:"POST",contentType:!1,processData:!1,data:i,beforeSend:function(e){},error:function(e,a){var t=AjaxErrorMessage(e,a);new AlertError("AJAX ERROR: "+t)},success:function(e){},complete:function(e){$("#loading_video").addClass("d-none"),b(e.responseJSON,a,"video")}});break;case"img":s=!1,$.ajax({url:"https://ul.pubpowerplatform.io/api/v1/image",type:"POST",contentType:!1,processData:!1,data:i,beforeSend:function(e){},error:function(e,a){var t=AjaxErrorMessage(e,a);new AlertError("AJAX ERROR: "+t)},success:function(e){},complete:function(e){$("#loading_thumb").addClass("d-none"),b(e.responseJSON,a,"img")}})}a.nextAll(".form-control").val(r.name)}function b(e,a,r){switch(e.status){case"error":1===e.errors.length&&""===e.errors[0].id?new AlertError(e.errors[0].message):e.errors.length>0?($.each(e.errors,(function(e,a){$("#"+a.id).addClass("is-invalid").nextAll("span.invalid-feedback").text(a.message)})),new AlertError(e.errors[0].message)):new AlertError("Error!");break;case"success":switch(r){case"video":$("#video_url").val(e.data_object.video_url),$(".select-thumb").parent().removeClass("cursor-not-allowed").removeClass("opacity-50"),$(".select-thumb").each((function(a){0===a&&(i&&$(".select-thumb").parent().removeClass("selected"),$(this).parent().addClass("selected"),$("#thumb").val(e.data_object.thumb[a]),$(".preview-thumb").attr("src",t+e.data_object.thumb[a]),i=!0),$(this).attr("src",t+e.data_object.thumb[a])})),$("#thumb").removeClass("is-invalid").next(".invalid-feedback").empty(),$("#box-upload-thumb").removeClass("is-invalid").next(".invalid-feedback").empty();var o=e.data_object.video_url.replace("/assets/video/","").replace(".m3u8","");$("#name_file").attr("value",o),$("#duration").val(e.data_object.duration),n=!0;break;case"img":case"thumb":$("#thumb").val(e.data_object.thumb[0]),$(".preview-thumb").attr("src",t+e.data_object.thumb[0]).removeClass("d-none"),$("#thumb").removeClass("is-invalid").next(".invalid-feedback").empty(),$(".select-thumb").parent().removeClass("selected"),i=!1,s=!0}break;default:new AlertError("Undefined")}}function p(e,a,t,n){var s=e[0];if("file"===s.type){var i=s.value;if(i.length>0){for(var r=!1,o=0;o<a.length;o++){var d=a[o];if(i.substr(i.length-d.length,d.length).toLowerCase()===d.toLowerCase()){r=!0,v(t,e,n);break}}if(!r)return new AlertError("Sorry, "+i+" is invalid, allowed extensions are: "+a.join(", ")),!1}}return!0}function u(){var e=[];return $("#list-tags").find(".tag-item").each((function(){e.push($(this).find("span").text())})),e}function m(){var e=[];if("done"===$(".pre-roll-break").attr("data-action")){var a={type:"preroll",break_mode:1,time_break:""};e.push(a)}if($(".box-adtag-url").each((function(){var a={};a.type=$(this).attr("data-type-roll"),a.break_mode=parseInt($(this).find(".break_mode").find("option:selected").val()),a.time_break=$(this).find(".time_break").val(),e.push(a)})),"done"===$(".post-roll-break").attr("data-action")){var t={type:"postroll",break_mode:1,time_break:""};e.push(t)}return e}function f(e,a){switch(e.status){case"error":1===e.errors.length&&""===e.errors[0].id?new AlertError(e.errors[0].message):e.errors.length>0?($.each(e.errors,(function(e,a){if($("#"+a.id).length){var t=$("#"+a.id);t.addClass("is-invalid").nextAll("span.invalid-feedback").text(a.message),t.addClass("is-invalid").closest(".bootstrap-select").addClass("is-invalid").nextAll("span.invalid-feedback").text(a.message)}else{$("."+a.id).each((function(){$(this).val()||$(this).addClass("is-invalid").nextAll("span.invalid-feedback").text(a.message)}))}})),$("#"+e.errors[0].id).focus(),$("#"+e.errors[0].id).prev("label").focus()):new AlertError("Error!");break;case"success":NoticeSuccess("Content has been created successfully"),setTimeout((function(){window.location.replace("/content")}),1e3);break;default:new AlertError("Undefined")}}$(document).ready((function(){$(".content-tab").on("click",".nav-link",(function(){$(".content-tab").find(".nav-link").removeClass("pp-4"),$(this).addClass("pp-4"),"1"!=$(this).attr("data-tab")?$(this).addClass("at-1"):$(".content-tab").find(".at-1").removeClass("at-1")})),function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=$("#"+e);i.find("input").on("click change blur",(function(e){var a=$(this);a.hasClass("is-invalid")&&a.removeClass("is-invalid").next(".invalid-feedback").empty()})),i.find(".list-ad-breaks").on("input","input",(function(e){var a=$(this);a.hasClass("is-invalid")&&a.removeClass("is-invalid").next(".invalid-feedback").empty()})),i.find("textarea").on("click change blur",(function(e){var a=$(this);a.hasClass("is-invalid")&&a.removeClass("is-invalid").next(".invalid-feedback").empty()})),i.find(".submit").on("click",(function(e){e.preventDefault();var r=$(this),o=r.text(),d="Loading...",l=i.serializeObject();l.channels=parseInt(l.channels),l.video_type=parseInt(l.video_type),l.duration=parseInt(l.duration),l.config_ad_break=parseInt(l.config_ad_break),l.video_url=$("#video_url").val(),1===$(".list-ad-breaks .box-c .bidder-box").length&&(l.ad_start_time=[l.ad_start_time]),l.keyword=u(),l.ad_breaks=m(),n?s?$.ajax({url:t,type:"POST",dataType:"JSON",contentType:"application/json",data:JSON.stringify(l),beforeSend:function(e){r.attr("disabled",!0).text(d)},error:function(e,a){var t=AjaxErrorMessage(e,a);new AlertError("AJAX ERROR: "+t),r.attr("disabled",!1).text(o)},success:function(e){r.attr("disabled",!1).text(o)},complete:function(e){a(e.responseJSON,i)}}):new AlertError("Thumb is processing, please wait a moment!"):new AlertError("Video is processing, please wait a moment!")}))}("createContent",f,"/content/add"),$("#upload_video").on("click",(function(){$("#box-upload-video").removeClass("is-invalid").next(".invalid-feedback").empty()})),$("#upload_thumb").on("click",(function(){$("#box-upload-thumb").removeClass("is-invalid").next(".invalid-feedback").empty()})),$("#upload_video").on("change",(function(e){$("#loading_video").removeClass("d-none"),p($(this),a,e,"video")})),$("#upload_thumb").on("change",(function(a){$("#loading_thumb").removeClass("d-none"),p($(this),e,a,"img")})),$(".select-thumb").parent().on("click",(function(){if($(this).hasClass("selected"))$(this).removeClass("selected"),$("#thumb").val(""),$(".preview-thumb").attr("src",""),i=!1;else{i&&$(".select-thumb").parent().removeClass("selected"),$(this).addClass("selected");var e=$(this).find(".select-thumb").attr("src");$(".preview-thumb").attr("src",e),$("#thumb").val(e.replace(t,"")),$("#box-upload-thumb").removeClass("is-invalid").next(".invalid-feedback").empty(),i=!0}})),_donetyping($(".input-tags"),10,(function(){""!==$(".input-tags").val()?$(".add-tag").removeClass("cursor-not-allowed"):$(".add-tag").addClass("cursor-not-allowed")})),$(".add-tag").click((function(){var e=$(".input-tags").val();if(e){var a='<div class="av2 tag-item">\n                        <div style="padding: 0 16px;display: inline-flex;">\n                            <span class="p-0">'+e+'</span>\n                             <a href="javascript:void(0)" class="remove-tag">\n                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="ds-icon-dashboard-cross">\n                                    <path d="M14.83 12l6.58-6.59a2 2 0 0 0-2.82-2.82L12 9.17 5.41 2.59a2 2 0 0 0-2.82 2.82L9.17 12l-6.58 6.59a2 2 0 1 0 2.82 2.82L12 14.83l6.59 6.58a2 2 0 0 0 2.82-2.82z">\n                                    </path>\n                                </svg>\n                            </a>\n                        </div>\n                    </div>';$("#list-tags").prepend(a),$(".input-tags").val(""),$(".add-tag").addClass("cursor-not-allowed")}})),document.getElementById("input-tags").addEventListener("keyup",(function(e){e.preventDefault(),13===e.keyCode&&$(".add-tag").click()})),$("#list-tags").on("click",".remove-tag",(function(){$(this).closest(".av2").remove()})),$("form").on("change","input",(function(){$(this).attr("name")&&(r=!0)})),$("form").on("change","select",(function(){$(this).attr("name")&&(r=!0)})),$("form").on("change","textarea",(function(){$(this).attr("name")&&(r=!0)})),$("a").click((function(){var e=$(this).attr("href");return"_blank"===$(this).attr("target")||"javascript:void(0)"===e||"#"===e||"#"===e.charAt(0)||!e||!r||(swal("apps.valueimpression.com says\nChanges that you made may not be saved.",{className:"red-bg",buttons:{cancel:"Cancel",catch:{text:"OK",value:"ok"}}}).then((function(a){if("ok"!==a)return!1;window.location=e})),!1)})),function(){function e(){"1"===$('input[name="config_ad_break"]:checked').val()?$(".add-break-manually").removeClass("d-none"):$(".add-break-manually").addClass("d-none")}e(),$("input[type=radio][name=config_ad_break]").change((function(){e()}))}(),$(".box-config-adbreak").on("click",".box-btn-add",(function(){var e=$(this).closest(".box-roll");e.find(".text-adtag-url").addClass("d-none");var a,t=o(e);"midroll"===t?($((a=t,'\n<div class="_breakConfig_z87zl_166 pp_ad_schedules_7 -orientation-vertical -gutter-s -wrap hydrated w-100 box-adtag-url" data-type-roll="'.concat(a,'">\n    <div style="padding: 12px 20px;">\n        <div class="pp_ad_schedules_7 -orientation-horizontal -justify-space-between -wrap hydrated">\n            <div style="padding: 12px 0px;">\n                <div class="pp_ad_schedules_7 -orientation-vertical -gutter-s -wrap hydrated">\n                    <div>\n                        <h4>Break Timing</h4>\n                        <div class="_breakTiming_z87zl_175 pp_ad_schedules_7 -orientation-horizontal -gutter-s -wrap hydrated">\n                            <div>\n                                <div class="_numberInput_z87zl_124 wui-input -size-m -empty hydrated box_time_break"\n                                     type="number">\n                                    <div class="wui-input__box box">\n                                        <input class="time_break" type="number" autocomplete="off" min="0" required="">\n                                    </div>\n                                </div>\n                                <div>\n                                    <div class="border border-gray-500 rounded-1 select-ad-schedules">\n                                        <select name="break_mode" class="break_mode selectpicker p-0 ">\n                                            <option value="1" selected>Seconds into Video</option>\n                                            <option value="2">Timecode</option>\n                                            <option value="3">% of Video</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div> \n            </div>\n        </div>\n    </div>\n</div>\n    '))).insertAfter(e),e.find(".box-step-roll").addClass("_editing_z87zl_152"),e.find(".box-btn-add").addClass("d-none"),e.find(".box-btn-action").addClass("d-none"),e.find(".box-btn-edit").removeClass("d-none"),e.attr("data-action","add"),e.next().find(".selectpicker").selectpicker("refresh")):(e.find(".box-btn-edit").addClass("d-none"),e.find(".box-btn-add").addClass("d-none"),e.find(".box-btn-action").removeClass("d-none"),e.find(".box-step-roll").removeClass().addClass("box-step-roll").addClass("_active_z87zl_147"),e.find("._inactive_iyx7e_22").removeClass("_inactive_iyx7e_22").addClass("_active_iyx7e_28"),e.attr("data-action","done"))})),$(".box-config-adbreak").on("click",".btn-cancel-roll",(function(){var e=$(this).closest(".box-roll");e.find(".text-adtag-url").removeClass("d-none"),e.find(".box-btn-edit").addClass("d-none");var a=e.next(),t=e.attr("data-action");if("add"===t)e.find(".box-step-roll").removeClass().addClass("box-step-roll"),e.find(".box-btn-add").removeClass("d-none"),a.hasClass("box-adtag-url")&&a.remove();else if("done"===t&&(e.find(".box-step-roll").removeClass().addClass("box-step-roll").addClass("_active_z87zl_147"),e.find("._inactive_iyx7e_22").removeClass("_inactive_iyx7e_22").addClass("_active_iyx7e_28"),e.find("._error_iyx7e_31").removeClass("_error_iyx7e_31").addClass("_active_iyx7e_28"),e.find(".box-btn-action").removeClass("d-none"),a.hasClass("box-adtag-url"))){var n=a.next();n.hasClass("box-adtag-url-backup")&&n.addClass("box-adtag-url").removeClass("box-adtag-url-backup"),a.remove()}})),$(".box-config-adbreak").on("click",".btn-done-roll",(function(){if(!$(this).hasClass("-disabled")){var e=$(this).closest(".box-roll");e.find(".text-adtag-url").removeClass("d-none"),e.find(".box-btn-edit").addClass("d-none"),e.find(".box-btn-action").removeClass("d-none"),e.find(".box-step-roll").removeClass().addClass("box-step-roll").addClass("_active_z87zl_147"),e.find("._inactive_iyx7e_22").removeClass("_inactive_iyx7e_22").addClass("_active_iyx7e_28");var a=e.next(),t=e.attr("data-action");if("add"===t)a.hasClass("box-adtag-url")&&(a.addClass("d-none"),e.attr("data-action","done"));else if("done"===t&&a.hasClass("box-adtag-url")){a.addClass("d-none");var n=a.next();n.hasClass("box-adtag-url-backup")&&n.remove()}var s=a.find(".break_mode").find("option:selected").val(),i=a.find(".time_break").val(),r="";"1"===s?r="Seconds into video: "+i+"s":"2"===s?r="Timecode: "+i:"3"===s&&(r="% Of Video: "+i+"%"),e.find(".text-adtag-url").text(r),l(o(e))}})),$(".box-config-adbreak").on("click",".btn-edit-roll",(function(){var e=$(this).closest(".box-roll");e.find(".text-adtag-url").addClass("d-none"),e.find(".box-step-roll").removeClass().addClass("box-step-roll").addClass("_editing_z87zl_152"),e.find("._active_iyx7e_28").addClass("_inactive_iyx7e_22").removeClass("_active_iyx7e_28"),e.find(".box-btn-add").addClass("d-none"),e.find(".box-btn-action").addClass("d-none"),e.find(".box-btn-edit").removeClass("d-none");var a=e.next();if(a.hasClass("box-adtag-url")){a.removeClass("d-none");var t=a.find(".break_mode").find("option:selected").val();$(a.clone()).insertAfter(a);var n=a.next();n.hasClass("box-adtag-url")&&(n.addClass("box-adtag-url-backup").removeClass("box-adtag-url").addClass("d-none"),n.find(".bootstrap-select").replaceWith((function(){return $("select",this)})),n.find(".break_mode").val(t),n.find(".selectpicker").selectpicker("render"))}$(".selectpicker").selectpicker("refresh")})),$(".box-config-adbreak").on("click",".btn-del-roll",(function(){var e=$(this).closest(".box-roll"),a=e.next();a.hasClass("box-adtag-url")&&a.remove();var t=o(e);"midroll"===t?l(t):$(c(t)).insertAfter(e),e.remove()})),$(".box-config-adbreak").on("input",".time_break",(function(){d($(this))})),$(".box-config-adbreak").on("changed.bs.select","select.break_mode",(function(){d($(this).closest(".box-adtag-url").find(".time_break"))}))}))})();